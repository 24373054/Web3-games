# ⚡ 快速开始指南

5分钟上手《瀛州纪》开发和游戏体验。

## 🎯 目标

完成本指南后，你将：
- ✅ 运行本地区块链
- ✅ 部署智能合约
- ✅ 启动游戏界面
- ✅ 创建你的第一个数字生命
- ✅ 与AI-NPC对话

## 📋 前置要求

确保已安装：
- ✅ Node.js (≥ 18)
- ✅ npm 或 yarn
- ✅ MetaMask 浏览器扩展

## 🚀 步骤

### 步骤 1: 克隆项目（如果还没有）

```bash
cd "C:\Users\23157\CODE\Web3\瀛州纪"
```

### 步骤 2: 安装依赖 (约2分钟)

```bash
npm install
```

### 步骤 3: 编译合约

```bash
npm run compile
```

应该看到：
```
Compiled 3 Solidity files successfully
```

### 步骤 4: 启动本地区块链 (新终端)

```bash
npx hardhat node
```

**保持此终端运行**，你会看到20个测试账户及其私钥。复制第一个账户的私钥备用。

### 步骤 5: 部署合约 (新终端)

```bash
npm run deploy
```

你会看到类似输出：
```
部署完成！
WorldLedger: 0x5FbDB231...
DigitalBeing: 0xe7f1725E...
AINPC: 0x9fE46736...
```

**复制这些地址**！

### 步骤 6: 配置环境变量

创建 `.env.local` 文件：

```env
NEXT_PUBLIC_CHAIN_ID=31337
NEXT_PUBLIC_RPC_URL=http://127.0.0.1:8545
NEXT_PUBLIC_WORLD_LEDGER_ADDRESS=你的WorldLedger地址
NEXT_PUBLIC_DIGITAL_BEING_ADDRESS=你的DigitalBeing地址
NEXT_PUBLIC_AINPC_ADDRESS=你的AINPC地址
```

### 步骤 7: 启动前端

```bash
npm run dev
```

打开浏览器访问：http://localhost:3000

### 步骤 8: 配置 MetaMask

1. 打开 MetaMask
2. 点击网络下拉菜单
3. 添加网络 → 手动添加网络
4. 填写信息：
   ```
   网络名称: Hardhat Local
   RPC URL: http://127.0.0.1:8545
   链 ID: 31337
   货币符号: ETH
   ```
5. 保存

6. 导入测试账户：
   - 点击账户图标
   - 导入账户
   - 粘贴从 hardhat node 复制的私钥

### 步骤 9: 开始游戏！

1. **连接钱包**：点击页面上的"连接钱包"
2. **创建数字生命**：点击"铸造数字生命 NFT"
3. **确认交易**：在 MetaMask 中确认
4. **选择NPC**：点击任意智能体（如"史官"）
5. **开始对话**：输入问题，例如：
   ```
   "告诉我瀛州的创世历史"
   "这个世界是如何运作的？"
   "什么是数字生命？"
   ```

## 🎮 试试这些

### 基础操作

```javascript
// 在浏览器控制台试试：

// 查看你的数字生命ID
const beingId = await digitalBeing.addressToBeingId(yourAddress)
console.log("我的Being ID:", beingId.toString())

// 查看世界状态
const state = await worldLedger.currentState()
console.log("当前世界状态:", state)

// 查看熵化程度
const entropy = await worldLedger.getEntropyLevel()
console.log("熵化程度:", entropy.toString() + "%")
```

### 高级操作（需要是合约owner）

```bash
# 在 hardhat console 中
npx hardhat console --network localhost

# 然后执行：
const WorldLedger = await ethers.getContractFactory("WorldLedger")
const worldLedger = await WorldLedger.attach("你的WorldLedger地址")

# 推进世界状态到"萌芽"纪元
await worldLedger.advanceState(1)

# 查看新状态
console.log(await worldLedger.currentState())
```

## 🐛 常见问题

### Q: MetaMask 显示"Nonce too high"

**A**: 重置账户
1. MetaMask → 设置 → 高级
2. 清除活动数据和 Nonce

### Q: 合约地址无效

**A**: 确保：
- hardhat node 还在运行
- 已正确复制合约地址到 `.env.local`
- 重启了前端服务（`npm run dev`）

### Q: 前端无法连接合约

**A**: 检查：
- MetaMask 是否切换到 Hardhat Local 网络
- RPC URL 是否正确 (http://127.0.0.1:8545)
- 浏览器控制台的错误信息

### Q: Gas 估算失败

**A**: 可能原因：
- 函数调用条件不满足（如非owner调用protected函数）
- 合约状态不允许（如世界已finalize）
- 账户余额不足

## 📖 下一步

现在你已经运行了游戏，可以：

1. **阅读完整文档**：
   - [README.md](./README.md) - 项目概述
   - [DEPLOYMENT.md](./DEPLOYMENT.md) - 部署到测试网
   - [PROJECT_STRUCTURE.md](./PROJECT_STRUCTURE.md) - 代码结构

2. **探索代码**：
   - 查看 `contracts/` 中的智能合约
   - 修改 `components/` 中的UI组件
   - 自定义 `lib/ai.ts` 中的AI回答

3. **扩展功能**：
   - 添加新的NPC类型
   - 创建新的事件类型
   - 设计新的纪元

4. **部署到测试网**：
   - 参考 [DEPLOYMENT.md](./DEPLOYMENT.md)
   - 使用 Sepolia 或其他测试网
   - 分享给朋友体验

## 🎉 恭喜！

你已经成功运行了《瀛州纪》！

现在你可以：
- 🎮 体验完整游戏流程
- 💻 修改代码进行开发
- 🚀 部署到公共测试网
- 🌟 贡献你的想法

## 💡 有用的命令

```bash
# 编译合约
npm run compile

# 运行测试
npm test

# 启动本地链
npx hardhat node

# 部署合约
npm run deploy

# 启动前端
npm run dev

# 构建生产版本
npm run build
```

## 📞 需要帮助？

- 查看 [README.md](./README.md)
- 阅读 [游戏思路.md](./游戏思路.md)
- 查看智能合约注释
- 检查浏览器控制台错误

---

**祝你在瀛州的旅程愉快！** 🌌

